{% extends "base.html" %}
{% load i18n %}

{% block title %}
SciELO Publishing Framework - {% trans 'Journals' %}
{% endblock %}

{% block content %}
<h1 class="h4 pt-5">{% trans 'Pending Documents' %}</h1>
    {% if search.exists %}
    
    <div class="row">
        <div class="col">
        <div class="card my-3">
            <div class="card-header">
                {% trans 'Search by ' %}
            </div>
            <div class="card-body">
                <form class="bg-white form-user">
                    {% csrf_token %}
                    <div class="row">
                    <div class="col">
                        <label for="issn" class="form-label">ISSN:</label>
                        <input class="form-control" type="text" name="issn">
                    </div>
                    <div class="col">
                        AND
                    </div>
                    <div class="col">
                        <label for="year" class="form-label">Year:</label>
                        <input class="form-control" type="text" name="year">
                    </div>
                    <div class="col">
                        OR
                    </div>
                    <div class="col">
                        <label for="pid" class="form-label">PID:</label>
                        <input class="form-control" type="text" name="pid">
                    </div>
                    </div>
                    <div>
                        <button type="submit" class="btn btn-primary">{% trans 'Search' %}</button>
                    </div>
                </form>
            </div>
        </div>
        </div>
    </div>
    
    {% endif %}
    <br><br>
    {% if documents_obj %}
    <form method="POST">
    {% csrf_token %}
    <div class="m-3">
        <div class="table-responsive">
            <table class="table table-sm table-bordered table-striped">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">{% trans 'PID' %}</th>
                    <th scope="col">{% trans 'Created' %}</th>
                    <th scope="col">{% trans 'Isis updated date' %}</th>
                    <th scope="col">{% trans 'Status' %}</th>
                    <th scope="col">{% trans 'Updated' %}</th>
                    <th scope="col">{% trans 'Migrate' %}</th>
                </tr>
                </thead>
                <tbody>
                {% for doc in documents_obj %}
                <tr>
                    <td>{{ documents_obj.start_index|add:forloop.counter0 }}</td>
                    <td>{{ doc.id }}</td>
                    <td>{{ doc.created }}</td>
                    <td>{{ doc.isis_updated_date }}</td>
                    <td>{{ doc.status }}</td>
                    <td>{{ doc.updated }}</td>
                    <td><input type="checkbox" name="document" value="{{ doc.id }}"></td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-4"> <button type="submit" name="migrate" value="select" class="btn btn-primary">{% trans 'Migrate selected documents' %}</button></div>
        <div class="col-sm-4"> <button type="submit" name="migrate" value="this" class="btn btn-primary">{% trans 'Migrate documents (this page)' %}</button></div>
        <div class="col-sm-4"> <button type="submit" name="migrate" value="all" class="btn btn-primary">{% trans 'Migrate ALL documents (all pages)' %}</button></div>
    </div>
    </form>
    <div class="row">&nbsp;</div>
    {% endif %}
</div>

<nav aria-label="Journal navigation">
    <ul class="pagination justify-content-center">
        {% if paginator.exists %}

            {% if paginator.has_previous %}
            <li class="page-item">
                <a class="page-link" href="{{ paginator.url }}page=1">&laquo; {% trans 'First' %}</a>
            </li>

            <li class="page-item">
                <a class="page-link"  href="{{ paginator.url }}page={{ paginator.previous_page_number }}">{% trans 'Previous' %}</a>
            </li>
            {% endif %}

            <li class="page-item">
                <a class="page-link">Page {{ paginator.page_number }} of {{ paginator.num_pages }}</a>
            </li>

            {% if paginator.has_next %}
            <li class="page-item">
                <a class="page-link" href="{{ paginator.url }}page={{ paginator.next_page_number }}">{% trans 'Next' %}</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="{{ paginator.url }}page={{ paginator.num_pages }}">{% trans 'Last' %} &raquo;</a>
            </li>
            {% endif %}

        {%else %}     
        
            {% if documents_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="{{ search.url }}page=1">&laquo; {% trans 'First' %}</a>
            </li>

            <li class="page-item">
                <a class="page-link"  href="{{ search.url }}page={{ documents_obj.previous_page_number }}">{% trans 'Previous' %}</a>
            </li>
            {% endif %}
            
            {% if documents_obj %}
            <li class="page-item">
                <a class="page-link">Page {{ documents_obj.number }} of {{ documents_obj.paginator.num_pages }}</a>
            </li>
            {% endif %}

            {% if documents_obj.has_next %}
            <li class="page-item">
                <a class="page-link" href="{{ search.url }}page={{ documents_obj.next_page_number }}">{% trans 'Next' %}</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="{{ search.url }}page={{ documents_obj.paginator.num_pages }}">{% trans 'Last' %} &raquo;</a>
            </li>
            {% endif %}
            
        {% endif %}
    </ul>
</nav>

{% endblock %}
